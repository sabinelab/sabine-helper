model Match {
  id        BigInt  @id @default(autoincrement())
  profile   Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)
  profileId String  @map("profile_id")

  mode   MatchMode
  winner Boolean
  teams  CareerTeam[]

  points   Int?     @db.SmallInt
  metadata Json
  when     DateTime @default(now())

  @@index([profileId, mode])
  @@index([profileId, when(sort: Desc)])
}

model CareerTeam {
  id      String @id @default(uuid())
  match   Match  @relation(fields: [matchId], references: [id], onDelete: Cascade)
  matchId BigInt @map("match_id")

  user  String
  score Int    @db.SmallInt

  @@index([matchId])
}

enum MatchMode {
  RANKED
  UNRANKED
  RANKED_SWIFTPLAY
  SWIFTPLAY
  TOURNAMENT
  ARENA
}
